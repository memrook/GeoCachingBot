# ๐ณ Docker ะดะตะฟะปะพะน GeoCaching Bot

ะะพะปะฝะพัะตะฝะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ ัะฐะทะฒะตัััะฒะฐะฝะธั GeoCaching Bot ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ Docker ะธ Docker Compose.

## ๐ ะัััััะน ััะฐัั

### 1. ะะพะดะณะพัะพะฒะบะฐ
```bash
# ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน
git clone <repository-url>
cd GeoCachingBot

# ะกะบะพะฟะธััะนัะต ะธ ะฝะฐัััะพะนัะต ะบะพะฝัะธะณััะฐัะธั
cp env.example .env
nano .env  # ะะฐัััะพะนัะต BOT_TOKEN ะธ ADMIN_ID

# ะะฐะฟัััะธัะต ะฑะพัะฐ
./deploy.sh start
```

### 2. ะัะพะฒะตัะบะฐ ััะฐัััะฐ
```bash
./deploy.sh status
./deploy.sh logs
```

## ๐ ะขัะตะฑะพะฒะฐะฝะธั

- **Docker** 20.10+
- **Docker Compose** 2.0+
- **Bash** (ะดะปั ัะบัะธะฟัะฐ deploy.sh)

## ๐๏ธ ะะพะผะฐะฝะดั ัะฟัะฐะฒะปะตะฝะธั

### ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั
```bash
./deploy.sh start     # ๐ ะะฐะฟััะบ ะฑะพัะฐ
./deploy.sh stop      # ๐ ะััะฐะฝะพะฒะบะฐ ะฑะพัะฐ
./deploy.sh restart   # ๐ ะะตัะตะทะฐะฟััะบ ะฑะพัะฐ
./deploy.sh status    # ๐ ะกัะฐััั ะธ ัะตััััั
./deploy.sh logs      # ๐ ะัะพัะผะพัั ะปะพะณะพะฒ
```

### ะะฟะตัะฐัะธะธ ั ะดะฐะฝะฝัะผะธ
```bash
./deploy.sh backup    # ๐พ ะกะพะทะดะฐะฝะธะต ะฑัะบะฐะฟะฐ
./deploy.sh update    # โฌ๏ธ ะะฑะฝะพะฒะปะตะฝะธะต ะฑะพัะฐ
./deploy.sh clean     # ๐งน ะะพะปะฝะฐั ะพัะธััะบะฐ (ะะกะขะะะะะะ!)
```

### ะะฐะทัะฐะฑะพัะบะฐ
```bash
./deploy.sh build     # ๐จ ะกะฑะพัะบะฐ ะพะฑัะฐะทะฐ
```

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
GeoCachingBot/
โโโ docker-compose.yml    # ะะพะฝัะธะณััะฐัะธั ัะตัะฒะธัะพะฒ
โโโ Dockerfile            # ะะฑัะฐะท ะฟัะธะปะพะถะตะฝะธั
โโโ deploy.sh             # ะกะบัะธะฟั ัะฟัะฐะฒะปะตะฝะธั
โโโ .dockerignore         # ะัะบะปััะตะฝะธั ะดะปั ัะฑะพัะบะธ
โโโ .env                  # ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
โโโ data/                 # ะะฐะทะฐ ะดะฐะฝะฝัั SQLite
โโโ photos/               # ะคะพัะพะณัะฐัะธะธ ัะฐะนะฝะธะบะพะฒ
โโโ logs/                 # ะะพะณะธ ะฟัะธะปะพะถะตะฝะธั
โโโ backups/              # ะัะบะฐะฟั ะดะฐะฝะฝัั
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะัะฝะพะฒะฝัะต ะฟะตัะตะผะตะฝะฝัะต (.env)
```bash
# ะะฑัะทะฐัะตะปัะฝัะต
BOT_TOKEN=ะฒะฐั_ัะพะบะตะฝ_ะฑะพัะฐ
ADMIN_ID=ะฒะฐั_user_id

# ะััะธ (ะฝะฐัััะพะตะฝั ะดะปั Docker)
DATABASE_PATH=/app/data/geocaching.db
PHOTO_STORAGE_PATH=/app/photos

# ะะฐัััะพะนะบะธ ะณะตะพะบััะธะฝะณะฐ
TARGET_DISTANCE_METERS=200
LIVE_LOCATION_DURATION_HOURS=1
```

### Docker Compose ะบะพะฝัะธะณััะฐัะธั
- **ะะฒัะพะฟะตัะตะทะฐะฟััะบ**: `restart: unless-stopped`
- **ะะธะผะธัั ัะตััััะพะฒ**: 256MB RAM, 0.5 CPU
- **Healthcheck**: ะัะพะฒะตัะบะฐ ะบะฐะถะดัะต 30 ัะตะบัะฝะด
- **ะะพะณะธัะพะฒะฐะฝะธะต**: ะะพัะฐัะธั ะฟะพ 10MB, 3 ัะฐะนะปะฐ

## ๐พ ะฃะฟัะฐะฒะปะตะฝะธะต ะดะฐะฝะฝัะผะธ

### Volumes
- `./data` โ `/app/data` - ะะฐะทะฐ ะดะฐะฝะฝัั SQLite
- `./photos` โ `/app/photos` - ะคะพัะพะณัะฐัะธะธ ัะฐะนะฝะธะบะพะฒ
- `./logs` โ `/app/logs` - ะะพะณะธ ะฟัะธะปะพะถะตะฝะธั

### ะัะบะฐะฟั
```bash
# ะะฒัะพะผะฐัะธัะตัะบะธะน ะฑัะบะฐะฟ
./deploy.sh backup

# ะััะฝะพะน ะฑัะบะฐะฟ
cp -r data photos .env backups/manual_$(date +%Y%m%d)
```

### ะะพัััะฐะฝะพะฒะปะตะฝะธะต
```bash
# ะััะฐะฝะพะฒะธัั ะฑะพัะฐ
./deploy.sh stop

# ะะพัััะฐะฝะพะฒะธัั ะดะฐะฝะฝัะต
cp -r backups/20241221_120000/data ./
cp -r backups/20241221_120000/photos ./

# ะะฐะฟัััะธัั ะฑะพัะฐ
./deploy.sh start
```

## ๐ ะะพะฝะธัะพัะธะฝะณ

### ะัะพัะผะพัั ััะฐัััะฐ
```bash
./deploy.sh status
```

ะัะฒะพะดะธั:
- ะกัะฐััั ะบะพะฝัะตะนะฝะตัะฐ
- ะัะฟะพะปัะทะพะฒะฐะฝะธะต CPU ะธ ะฟะฐะผััะธ
- ะกะตัะตะฒัั ะฐะบัะธะฒะฝะพััั

### ะัะพัะผะพัั ะปะพะณะพะฒ
```bash
# ะะพัะปะตะดะฝะธะต 100 ัััะพะบ ั follow
./deploy.sh logs

# ะะพะณะธ ะทะฐ ะพะฟัะตะดะตะปะตะฝะฝัะน ะฟะตัะธะพะด
docker-compose logs --since=1h geocaching-bot

# ะะพะณะธ ั ัะธะปัััะฐัะธะตะน
docker-compose logs geocaching-bot | grep ERROR
```

### Healthcheck
ะะฒัะพะผะฐัะธัะตัะบะฐั ะฟัะพะฒะตัะบะฐ ัะพััะพัะฝะธั ะบะฐะถะดัะต 30 ัะตะบัะฝะด:
- โ Healthy - ะฟัะพัะตัั ัะฐะฑะพัะฐะตั
- โ Unhealthy - ะฟัะพัะตัั ะฝะต ะพัะฒะตัะฐะตั

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะตะบะพะผะตะฝะดะฐัะธะธ
- โ ะะพั ัะฐะฑะพัะฐะตั ะฟะพะด ะฝะตะฟัะธะฒะธะปะตะณะธัะพะฒะฐะฝะฝัะผ ะฟะพะปัะทะพะฒะฐัะตะปะตะผ
- โ .env ัะฐะนะป ะธัะบะปััะตะฝ ะธะท Docker ะพะฑัะฐะทะฐ
- โ ะะฐะฝะฝัะต ััะฐะฝัััั ะฒ ะทะฐัะธัะตะฝะฝัั volumes
- โ ะะธะผะธัั ัะตััััะพะฒ ะฟัะตะดะพัะฒัะฐัะฐัั DoS

### ะคะฐะนะตัะฒะพะป (ะพะฟัะธะพะฝะฐะปัะฝะพ)
```bash
# ะัะปะธ ะฝัะถะฝั ะฒะฝะตัะฝะธะต ะฟะพััั
sudo ufw allow 8080/tcp  # ะขะพะปัะบะพ ะตัะปะธ ะฟะปะฐะฝะธััะตััั ะฒะตะฑ-ะธะฝัะตััะตะนั
```

## ๐จ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะะพั ะฝะต ะทะฐะฟััะบะฐะตััั
```bash
# ะัะพะฒะตัััะต ะปะพะณะธ
./deploy.sh logs

# ะัะพะฒะตัััะต ะบะพะฝัะธะณััะฐัะธั
cat .env | grep -v "^#"

# ะะตัะตัะพะฑะตัะธัะต ะพะฑัะฐะท
./deploy.sh build
./deploy.sh start
```

### ะัะธะฑะบะธ ะดะพัััะฟะฐ ะบ ัะฐะนะปะฐะผ
```bash
# ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะดะพัััะฟะฐ
ls -la data/ photos/

# ะัะฟัะฐะฒััะต ะฟัะฐะฒะฐ (ะตัะปะธ ะฝัะถะฝะพ)
chmod 755 data photos
```

### ะัะพะฑะปะตะผั ั ะฟะฐะผัััั
```bash
# ะัะพะฒะตัััะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ
./deploy.sh status

# ะฃะฒะตะปะธัััะต ะปะธะผะธัั ะฒ docker-compose.yml
# memory: 512M  # ะฑัะปะพ 256M
```

### ะัะธััะบะฐ ะธ ะฟะตัะตัััะฐะฝะพะฒะบะฐ
```bash
# ะะพะปะฝะฐั ะพัะธััะบะฐ (ัะพััะฐะฝะธั ะดะฐะฝะฝัะต)
./deploy.sh clean

# ะะฐะฝะพะฒะพ ัะฑะพัะบะฐ ะธ ะทะฐะฟััะบ
./deploy.sh build
./deploy.sh start
```

## ๐ ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

### ะะพัะธะทะพะฝัะฐะปัะฝะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต
ะัะปะธ ะฝัะถะฝะพ ะพะฑัะฐะฑะฐััะฒะฐัั ะฑะพะปััะต ะฟะพะปัะทะพะฒะฐัะตะปะตะน:

```yaml
# docker-compose.yml
services:
  geocaching-bot:
    scale: 2  # ะะพะฑะฐะฒะธัั ะฒ deploy ัะตะบัะธั
```

โ๏ธ **ะะฝะธะผะฐะฝะธะต**: SQLite ะฝะต ะฟะพะดะดะตัะถะธะฒะฐะตั ะฟะฐัะฐะปะปะตะปัะฝัั ะทะฐะฟะธัั ะธะท ะฝะตัะบะพะปัะบะธั ะฟัะพัะตััะพะฒ!

### ะะพะฝะธัะพัะธะฝะณ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
```bash
# ะะพะฝะธัะพัะธะฝะณ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
watch -n 5 "docker stats geocaching-bot --no-stream"

# ะะพะณะธ ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
docker-compose logs geocaching-bot | grep -E "(ะฒัะตะผั|memory|cpu)"
```

## ๐ CI/CD ะธะฝัะตะณัะฐัะธั

### GitHub Actions ะฟัะธะผะตั
```yaml
# .github/workflows/deploy.yml
name: Deploy Bot
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Deploy to server
        run: |
          ssh user@server "cd /path/to/bot && git pull && ./deploy.sh update"
```

## ๐ ะะพะดะดะตัะถะบะฐ

ะัะธ ะฟัะพะฑะปะตะผะฐั ั Docker ะดะตะฟะปะพะตะผ:

1. ๐ ะกะพะฑะตัะธัะต ะปะพะณะธ: `./deploy.sh logs > logs.txt`
2. ๐ ะัะพะฒะตัััะต ััะฐััั: `./deploy.sh status`
3. ๐ ะัะพะฒะตัััะต ะบะพะฝัะธะณััะฐัะธั: `cat .env`
4. ๐พ ะกะพะทะดะฐะนัะต ะฑัะบะฐะฟ: `./deploy.sh backup`

---

**๐ฏ ะะพัะพะฒะพ! ะะฐั GeoCaching Bot ัะฐะฑะพัะฐะตั ะฒ Docker!** ๐ 